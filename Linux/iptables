iptables

Ограничивает доступ на уровне сети
Конфигурация состоит из цепочек правил
Управляется командой iptables

-A добавление нового правила. -p протокол. --dport порт. -m модуль. -s источник. -j действие. -i входной сетевой интерфейс. -o исходящий сетевой интерфейс. Конфиг /etc/sysconfig/iptables
Типы правил - Существует три типа правил iptables — input, forward и output.
Input — Такие цепочки используются для контроля поведения входящих соединений. К примеру, если пользователь попробует подключиться к серверу по SSH, 
то iptables сравнит его IP-адрес со своим списком, чтобы разрешить или запретить доступ.
Forward — Правила этого типа используются для обработки входящих сообщений, конечный пункт назначения которых не является текущим сервером. 
К примеру, в случае маршрутизатора, к нему подключаются многие пользователи и приложения, но данные не посылаются на сам маршрутизатор, они лишь передаются ему, 
чтобы он мог перенаправить их адресату. Если вы не занимаетесь настройкой маршрутизации или NAT, то правила этого типа использовать в работе не будете.
Output — Такие цепочки используются для исходящих соединений. К прмиеру, если пользователь пытается отправинг запрос ping к сайту 1cloud.ru, 
iptables изучит цепочку правил, чтобы понять, что нужно делать в случае ping и этого сайт, и только потом разрешит или запретит соединение.

Действия с соединениями - После настройки поведения межсетевого экрана по умолчанию, можно переходить к созданию правил обработки трафика, чтобы iptables понимал, 
что делать с конкретным соединением.
Accept — разрешить соединение;
Drop — игнорировать соединение, вести себя так, будто его никогда не было. Действие подходит для случаев, когда нужно сделать так, чтобы источник запроса не узнал о его блокировке.
Reject — заблокировать соединение и отправить в ответ сообщение об ошибке действие подходит для тех случаев когда владелец сервера хочет дать понять что соединение заблокировано файрволом
LOG - сделать запись о пакете в лог файл; QUEUE - отправить пакет пользовательскому приложению.
MARK — позволяет помечать определенные пакеты, например для маршрутизации, данная метка перестает существовать, как только пакет покинет брандмауэр;
CONNMARK — то же самое, что и MARK, только для соединений; QUEUE — отправляет пакет в очередь приложению для дальнейшего взаимодействия;
RETURN — прекращение движения пакета по текущей цепочке и возврат в предыдущую цепочку. Если текущая цепочка единственная — к пакету будет применено действие по умолчанию;
REDIRECT — перенаправляет пакет на указанный порт, в пределах этого же узла, применяется для реализации «прозрачного» прокси;
DNAT — подменяет адрес получателя в заголовке IP-пакета, основное применение — предоставление доступа к сервисам снаружи, находящимся внутри сети;
SNAT — для преобразования сетевых адресов, применимо, когда за сервером находятся машины, которым необходимо предоставить доступ в Интернет, при этом от провайдера имеется статический IP
MASQUERADE — то же, что и SNAT, но главное отличие, может использоваться, когда провайдер предоставляет динамический адрес, создаёт дополнительную нагрузку на систему по сравнению с SNAT
TOS — позволяет управлять битами в одноименном поле заголовка IP-пакета; ULOG — более продвинутый вариант записи информации, может писать как в обычный текстовый файл, так и в базу данных
TTL — используется для изменения значения поля одноименного заголовка IP-пакета, устанавливает время жизни пакета.

Таблица mangle - Предназначена для модификации заголовков сетевых пакетов, таких параметров как ToS (Type of Service), TTL (Time To Live), MARK. Содержит все существующие пять цепочек.
Таблица nat - для трансляции сетевых адресов подмены адреса получателя/отправителя применяется если сервер используется в качестве маршрутизатора. Цепочки PREROUTING, OUTPUT, POSTROUTING
Таблица filter - служит для фильтрации пакетов, именно здесь происходит принятие решений о разрешении или запрете дальнейшего движения пакета в системе. Цепочки INPUT, FORWARD и OUTPUT.

NEW - пакеты, устанавливающие новое соединение. ESTABLISHED - пакеты, принадлежащие установленному соединению. RELATED - пакеты, не принадлежащие установленному соединению 
Пакеты, являющиеся частью новых соединений, инициированые уже установленным ESTABLISHED соединением
INVALID — помечаются пакеты, которые не связаны ни с одним из существующих соединений, и не могут создать новое, их невозможно идентифицировать. 
В целях безопасности рекомендуется остановить движение таких пакетов по системе, используя действие DROP.

prerouting - в эту цепочку пакет попадает перед обработкой iptables, система еще не знает куда он будет отправлен, в input, output или forward;
postrouting - сюда попадают все проходящие пакеты, которые уже прошли цепочку forward